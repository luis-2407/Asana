<Activity mc:Ignorable="sap sap2010" x:Class="ModifyAdjunctReappointmentLetter" this:ModifyAdjunctReappointmentLetter.in_adminEmail="lap10@rice.edu" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:isactr="http://schemas.uipath.com/workflow/integration-service-activities/isactr" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:njl="clr-namespace:Newtonsoft.Json.Linq;assembly=Newtonsoft.Json" xmlns:p="http://schemas.uipath.com/workflow/activities/word" xmlns:s="clr-namespace:System;assembly=System.Private.CoreLib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=System.Private.CoreLib" xmlns:sco="clr-namespace:System.Collections.ObjectModel;assembly=System.Private.CoreLib" xmlns:this="clr-namespace:" xmlns:ucas="clr-namespace:UiPath.Core.Activities.Storage;assembly=UiPath.System.Activities" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:upr="clr-namespace:UiPath.Platform.ResourceHandling;assembly=UiPath.Platform" xmlns:uwah="clr-namespace:UiPath.Web.Activities.Http;assembly=UiPath.Web.Activities" xmlns:uwahm="clr-namespace:UiPath.Web.Activities.Http.Models;assembly=UiPath.Web.Activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property Name="in_adminEmail" Type="InArgument(x:String)" />
    <x:Property Name="in_taskGID" Type="InArgument(x:String)" />
    <x:Property Name="in_downloadFolder" Type="InArgument(x:String)" />
    <x:Property Name="in_department" Type="InArgument(x:String)" />
    <x:Property Name="in_title" Type="InArgument(x:String)" />
    <x:Property Name="in_taskName" Type="InArgument(x:String)" />
    <x:Property Name="in_dictCV" Type="InArgument(scg:Dictionary(x:String, x:String))" />
    <x:Property Name="in_dictChairMemo" Type="InArgument(scg:Dictionary(x:String, x:String))" />
  </x:Members>
  <VisualBasic.Settings>
    <x:Null />
  </VisualBasic.Settings>
  <sap2010:WorkflowViewState.IdRef>ModifyAdjunctReappointmentLetter_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <sco:Collection x:TypeArguments="x:String">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>GlobalVariablesNamespace</x:String>
      <x:String>GlobalConstantsNamespace</x:String>
      <x:String>UiPath.Word</x:String>
      <x:String>UiPath.Shared.Activities.Business</x:String>
      <x:String>UiPath.Word.Activities</x:String>
      <x:String>UiPath.Web.Activities.Http.Models</x:String>
      <x:String>System.Runtime.Serialization</x:String>
      <x:String>System.Security</x:String>
      <x:String>System.Net</x:String>
      <x:String>UiPath.Platform.ResourceHandling</x:String>
      <x:String>System.Reflection</x:String>
      <x:String>UiPath.Web.Activities.Http</x:String>
      <x:String>UiPath.Sdk.Activities</x:String>
      <x:String>UiPath.Sdk.Activities.DependencyInjection.Contracts</x:String>
      <x:String>UiPath.Sdk.Activities.DependencyInjection</x:String>
      <x:String>System.Linq.Expressions</x:String>
      <x:String>UiPath.Web.Activities</x:String>
      <x:String>System.Numerics</x:String>
      <x:String>UiPath.IntegrationService.Activities.SWEntities.CE57C3C636C_tasks_Replace.Bundle</x:String>
      <x:String>UiPath.IntelligentOCR.StudioWeb.Activities.SWEntities.ExtendedExtractionResultsForDocumentData.GptIxp34.Bundle</x:String>
      <x:String>System.ComponentModel</x:String>
      <x:String>UiPath.IntelligentOCR.StudioWeb.Activities.DataExtraction</x:String>
      <x:String>UiPath.Core.Activities.Storage</x:String>
      <x:String>UiPath.Core.Activities.Orchestrator</x:String>
      <x:String>UiPath.Platform</x:String>
      <x:String>System.Globalization</x:String>
      <x:String>UiPath.IntegrationService.Activities.Runtime.Models.FilterBuilder</x:String>
      <x:String>UiPath.IntegrationService.Activities.Runtime.Models</x:String>
      <x:String>UiPath.IntegrationService.Activities.Runtime.Helpers.TypeDetailsCustomization</x:String>
      <x:String>UiPath.IntegrationService.Activities.Runtime.Activities</x:String>
      <x:String>UiPath.Platform.Activities</x:String>
      <x:String>UiPath.IntegrationService.Activities.SWEntities.CE9C9C83C26_projects_sub_tasks.Bundle</x:String>
      <x:String>UiPath.IntegrationService.Activities.SWEntities.C7B246E9CE8_tasks_Retrieve.Bundle</x:String>
      <x:String>UiPath.IntegrationService.Activities.SWEntities.CE9C9C83C26_projects.Bundle</x:String>
      <x:String>UiPath.IntegrationService.Activities.SWEntities.CE9C9C83C26_tasks_Replace.Bundle</x:String>
      <x:String>System.Text.RegularExpressions</x:String>
      <x:String>UiPath.Web.Activities.JSON.Models</x:String>
      <x:String>Newtonsoft.Json.Linq</x:String>
      <x:String>Newtonsoft.Json</x:String>
      <x:String>System.Dynamic</x:String>
      <x:String>System.Collections.Specialized</x:String>
      <x:String>UiPath.IntegrationService.Activities.SWEntities.CB26248ECE7_v2_sub_generateChatCompletion_Create.Bundle</x:String>
    </sco:Collection>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <sco:Collection x:TypeArguments="AssemblyReference">
      <AssemblyReference>C7B246E9CE8_tasks_Re.v58lB2e0lYE1IRd9vAKGxo1</AssemblyReference>
      <AssemblyReference>CE57C3C636C_tasks_Re.0XEw23ZnTRJ1jsF443CPpU1</AssemblyReference>
      <AssemblyReference>CE9C9C83C26_projects.8iQ0w3NZlAH1qKXLAbs6C4</AssemblyReference>
      <AssemblyReference>CE9C9C83C26_projects.IfOj9202TtI181yAk2295j23</AssemblyReference>
      <AssemblyReference>ExtendedExtractionRe.aCVbXYJonC14YhLsH6rQf4</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>NPOI</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>System.Collections</AssemblyReference>
      <AssemblyReference>System.Collections.NonGeneric</AssemblyReference>
      <AssemblyReference>System.ComponentModel</AssemblyReference>
      <AssemblyReference>System.ComponentModel.EventBasedAsync</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Primitives</AssemblyReference>
      <AssemblyReference>System.ComponentModel.TypeConverter</AssemblyReference>
      <AssemblyReference>System.Configuration.ConfigurationManager</AssemblyReference>
      <AssemblyReference>System.Console</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.Common</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Drawing.Common</AssemblyReference>
      <AssemblyReference>System.Drawing.Primitives</AssemblyReference>
      <AssemblyReference>System.Linq</AssemblyReference>
      <AssemblyReference>System.Linq.Async</AssemblyReference>
      <AssemblyReference>System.Linq.Expressions</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>System.Memory.Data</AssemblyReference>
      <AssemblyReference>System.Net.HttpListener</AssemblyReference>
      <AssemblyReference>System.Net.Mail</AssemblyReference>
      <AssemblyReference>System.Net.NameResolution</AssemblyReference>
      <AssemblyReference>System.Net.Primitives</AssemblyReference>
      <AssemblyReference>System.Net.Requests</AssemblyReference>
      <AssemblyReference>System.Net.ServicePoint</AssemblyReference>
      <AssemblyReference>System.Net.WebClient</AssemblyReference>
      <AssemblyReference>System.Net.WebHeaderCollection</AssemblyReference>
      <AssemblyReference>System.Net.WebProxy</AssemblyReference>
      <AssemblyReference>System.ObjectModel</AssemblyReference>
      <AssemblyReference>System.Private.CoreLib</AssemblyReference>
      <AssemblyReference>System.Private.DataContractSerialization</AssemblyReference>
      <AssemblyReference>System.Private.ServiceModel</AssemblyReference>
      <AssemblyReference>System.Private.Uri</AssemblyReference>
      <AssemblyReference>System.Reflection.DispatchProxy</AssemblyReference>
      <AssemblyReference>System.Reflection.Metadata</AssemblyReference>
      <AssemblyReference>System.Reflection.TypeExtensions</AssemblyReference>
      <AssemblyReference>System.Runtime.InteropServices</AssemblyReference>
      <AssemblyReference>System.Runtime.Numerics</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization.Formatters</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization.Primitives</AssemblyReference>
      <AssemblyReference>System.Security.Permissions</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>UiPath.CodedWorkflows</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities</AssemblyReference>
      <AssemblyReference>UiPath.IntegrationService.Activities.Runtime</AssemblyReference>
      <AssemblyReference>UiPath.IntelligentOCR.StudioWeb.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Mail.Activities</AssemblyReference>
      <AssemblyReference>UiPath.MicrosoftOffice365.Activities</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Platform</AssemblyReference>
      <AssemblyReference>UiPath.Studio.Constants</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Testing.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationCore</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationNext.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Web.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Word</AssemblyReference>
      <AssemblyReference>UiPath.Word.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Word.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.Workflow</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>CE9C9C83C26_tasks_Re.3RtzP31kVFE1cl59L11TnfQ3</AssemblyReference>
      <AssemblyReference>System.Text.RegularExpressions</AssemblyReference>
      <AssemblyReference>Newtonsoft.Json</AssemblyReference>
      <AssemblyReference>System.Collections.Specialized</AssemblyReference>
      <AssemblyReference>CB26248ECE7_v2_sub_g.KFVw43jU2UQ1NgLIT2SMTth2</AssemblyReference>
    </sco:Collection>
  </TextExpression.ReferencesForImplementation>
  <Sequence DisplayName="ModifyAdjunctReappointmentLetter" sap:VirtualizedContainerService.HintSize="1394,5307" sap2010:WorkflowViewState.IdRef="Sequence_1">
    <Sequence.Variables>
      <Variable x:TypeArguments="scg:Dictionary(x:String, x:String)" Default="[New Dictionary(Of String,String) From {&#xA;    {&quot;Ready for automation&quot;,&quot;1212913254438530&quot;},&#xA;    {&quot;Ready to review&quot;,&quot;1212913254438531&quot;},&#xA;    {&quot;Letter reviewed&quot;,&quot;1212913254438532&quot;},&#xA;    {&quot;Sent for signature (Adobe Sign)&quot;,&quot;1212913254438533&quot;},&#xA;    {&quot;Letter signed&quot;,&quot;1212913254438534&quot;},&#xA;    {&quot;Error&quot;,&quot;1212913254438535&quot;}&#xA;}]" Name="mapStatus" />
    </Sequence.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <Sequence DisplayName="Modify Adjunct Reappointment Letter" sap:VirtualizedContainerService.HintSize="486,5284" sap2010:WorkflowViewState.IdRef="Sequence_2">
      <Sequence.Variables>
        <Variable x:TypeArguments="scg:Dictionary(x:Int32, x:String)" Default="[New Dictionary(Of Integer, String) From {&#xA;    {1,&quot;one&quot;},&#xA;    {2,&quot;two&quot;},&#xA;    {3,&quot;three&quot;},&#xA;    {4,&quot;four&quot;},&#xA;    {5,&quot;five&quot;},&#xA;    {6,&quot;six&quot;},&#xA;    {7,&quot;seven&quot;},&#xA;    {8,&quot;eight&quot;},&#xA;    {9,&quot;nine&quot;}&#xA;}]" Name="numberToLetterDict" />
        <Variable x:TypeArguments="uwahm:HttpResponseSummary" Name="apiOutput" />
        <Variable x:TypeArguments="x:Int32" Name="statusCode" />
        <Variable x:TypeArguments="x:String" Name="apiResponse" />
        <Variable x:TypeArguments="upr:ILocalResource" Name="result" />
        <Variable x:TypeArguments="x:String" Name="endDate" />
        <Variable x:TypeArguments="x:String" Name="startDate" />
        <Variable x:TypeArguments="x:String" Name="saveFolder" />
        <Variable x:TypeArguments="x:String" Name="request" />
        <Variable x:TypeArguments="x:String" Name="updateStatusLink" />
        <Variable x:TypeArguments="x:String" Name="numberMatch" />
        <Variable x:TypeArguments="x:String" Name="outSubtask" />
        <Variable x:TypeArguments="njl:JObject" Name="outSubtaskObject" />
        <Variable x:TypeArguments="njl:JArray" Name="taskJArray" />
        <Variable x:TypeArguments="x:String" Name="draftTaskGID" />
        <Variable x:TypeArguments="x:String" Name="endDateOutput" />
        <Variable x:TypeArguments="x:String" Name="startDateOutput" />
        <Variable x:TypeArguments="x:String" Name="normalizedName" />
        <Variable x:TypeArguments="uwahm:HttpResponseSummary" Name="outAdminGID" />
        <Variable x:TypeArguments="x:String" Name="normalizedNameChair" />
      </Sequence.Variables>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="452,175" sap2010:WorkflowViewState.IdRef="LogMessage_1" Level="Info" Message="[&quot;Started Modify Adjunt Letter&quot;]" />
      <ucas:DownloadStorageFile TimeoutMS="{x:Null}" Destination="Data\Input\Adjunct Reappointment - Template.docx" DisplayName="Download Storage File" FolderPath="Academic Affairs/Schools/Engineering/Faculty_Reappointments_Automation" sap:VirtualizedContainerService.HintSize="452,167" sap2010:WorkflowViewState.IdRef="DownloadStorageFile_1" Path="Adjunct Reappointment - Template.docx" Result="[result]" StorageBucketName="Templates" />
      <Assign DisplayName="Assign - Format End Date" sap:VirtualizedContainerService.HintSize="452,175" sap2010:WorkflowViewState.IdRef="Assign_1">
        <Assign.To>
          <OutArgument x:TypeArguments="x:String">[endDate]</OutArgument>
        </Assign.To>
        <Assign.Value>
          <InArgument x:TypeArguments="x:String" xml:space="preserve">[DateTime.ParseExact(
    in_dictChairMemo("ReappointmentEndDate").ToString(),
    "MM/dd/yyyy HH:mm:ss",
    Globalization.CultureInfo.InvariantCulture
).ToString("MMMM d, yyyy")]</InArgument>
        </Assign.Value>
      </Assign>
      <Assign DisplayName="Assign - Format End Date" sap:VirtualizedContainerService.HintSize="452,175" sap2010:WorkflowViewState.IdRef="Assign_10">
        <Assign.To>
          <OutArgument x:TypeArguments="x:String">[endDateOutput]</OutArgument>
        </Assign.To>
        <Assign.Value>
          <InArgument x:TypeArguments="x:String" xml:space="preserve">[DateTime.ParseExact(
    in_dictChairMemo("ReappointmentEndDate").ToString(),
    "MM/dd/yyyy HH:mm:ss",
    Globalization.CultureInfo.InvariantCulture
).ToString("MMMM yyyy")]</InArgument>
        </Assign.Value>
      </Assign>
      <Assign DisplayName="Assign - Format Start Date" sap:VirtualizedContainerService.HintSize="452,175" sap2010:WorkflowViewState.IdRef="Assign_2">
        <Assign.To>
          <OutArgument x:TypeArguments="x:String">[startDate]</OutArgument>
        </Assign.To>
        <Assign.Value>
          <InArgument x:TypeArguments="x:String" xml:space="preserve">[DateTime.ParseExact(
    in_dictChairMemo("ReappointmentStartDate").ToString(),
    "MM/dd/yyyy HH:mm:ss",
    Globalization.CultureInfo.InvariantCulture
).ToString("MMMM d, yyyy")]</InArgument>
        </Assign.Value>
      </Assign>
      <Assign DisplayName="Assign - Format Start Date" sap:VirtualizedContainerService.HintSize="452,175" sap2010:WorkflowViewState.IdRef="Assign_11">
        <Assign.To>
          <OutArgument x:TypeArguments="x:String">[startDateOutput]</OutArgument>
        </Assign.To>
        <Assign.Value>
          <InArgument x:TypeArguments="x:String" xml:space="preserve">[DateTime.ParseExact(
    in_dictChairMemo("ReappointmentStartDate").ToString(),
    "MM/dd/yyyy HH:mm:ss",
    Globalization.CultureInfo.InvariantCulture
).ToString("MMMM yyyy")]</InArgument>
        </Assign.Value>
      </Assign>
      <Assign DisplayName="Assign - Save Folder Modified Letter" sap:VirtualizedContainerService.HintSize="452,175" sap2010:WorkflowViewState.IdRef="Assign_3">
        <Assign.To>
          <OutArgument x:TypeArguments="x:String">[saveFolder]</OutArgument>
        </Assign.To>
        <Assign.Value>
          <InArgument x:TypeArguments="x:String" xml:space="preserve">[(in_downloadFolder + "\" + in_taskName + "\" + in_taskName + "  -  " + startDateOutput + "_" + endDateOutput + " Adjunct Reappointment.docx").Trim()]</InArgument>
        </Assign.Value>
      </Assign>
      <Assign DisplayName="Assign - Ready to Review Request" sap:VirtualizedContainerService.HintSize="452,175" sap2010:WorkflowViewState.IdRef="Assign_4">
        <Assign.To>
          <OutArgument x:TypeArguments="x:String">[request]</OutArgument>
        </Assign.To>
        <Assign.Value>
          <InArgument x:TypeArguments="x:String">["{""data"":{""custom_fields"":{""1212913254438529"":""" &amp; mapStatus("Ready to review") &amp; """}}}"]</InArgument>
        </Assign.Value>
      </Assign>
      <Assign DisplayName="Assign - Link Status" sap:VirtualizedContainerService.HintSize="452,175" sap2010:WorkflowViewState.IdRef="Assign_5">
        <Assign.To>
          <OutArgument x:TypeArguments="x:String">[updateStatusLink]</OutArgument>
        </Assign.To>
        <Assign.Value>
          <InArgument x:TypeArguments="x:String">[("https://app.asana.com/api/1.0"+"/tasks/" + in_taskGID).Trim]</InArgument>
        </Assign.Value>
      </Assign>
      <ui:Matches DisplayName="Find Matching Patterns" FirstMatch="[numberMatch]" sap:VirtualizedContainerService.HintSize="452,92" sap2010:WorkflowViewState.IdRef="Matches_1" Input="[in_dictChairMemo(&quot;ReappointmentTerm&quot;).ToString]" IsBuilderTabModified="False" Pattern="\d+" RegexOption="IgnoreCase, Compiled" />
      <ui:InvokeCode ContinueOnError="{x:Null}" Code="' Arguments expected:&#xD;&#xA;'   inputName (In, String)&#xD;&#xA;'   result    (Out, String)&#xD;&#xA;&#xD;&#xA;Dim s As String = If(inputName, &quot;&quot;).Trim()&#xD;&#xA;If s = &quot;&quot; Then&#xD;&#xA;    result = &quot;&quot;&#xD;&#xA;    Return&#xD;&#xA;End If&#xD;&#xA;&#xD;&#xA;' --- Dictionaries (HashSets) ---&#xD;&#xA;Dim titles = New System.Collections.Generic.HashSet(Of String)(System.StringComparer.OrdinalIgnoreCase) From {&#xD;&#xA;    &quot;dr&quot;, &quot;dr.&quot;, &quot;doctor&quot;, &quot;prof&quot;, &quot;prof.&quot;, &quot;professor&quot;, &quot;mr&quot;, &quot;mr.&quot;, &quot;mrs&quot;, &quot;mrs.&quot;, &quot;ms&quot;, &quot;ms.&quot;, &quot;miss&quot;, &quot;sir&quot;,&#xD;&#xA;    &quot;ing&quot;, &quot;ing.&quot;, &quot;eng&quot;, &quot;eng.&quot;, &quot;lic&quot;, &quot;lic.&quot;, &quot;arq&quot;, &quot;arq.&quot;, &quot;rev&quot;, &quot;rev.&quot;, &quot;fr&quot;, &quot;fr.&quot;&#xD;&#xA;}&#xD;&#xA;Dim credentials = New System.Collections.Generic.HashSet(Of String)(System.StringComparer.OrdinalIgnoreCase) From {&#xD;&#xA;    &quot;phd&quot;, &quot;msc&quot;, &quot;ms&quot;, &quot;ma&quot;, &quot;mba&quot;, &quot;bsc&quot;, &quot;ba&quot;, &quot;bs&quot;, &quot;jd&quot;, &quot;md&quot;, &quot;edd&quot;, &quot;dphil&quot;, &quot;mpp&quot;, &quot;mph&quot;, &quot;mfa&quot;, &quot;llm&quot;,&#xD;&#xA;    &quot;llb&quot;, &quot;dds&quot;, &quot;dmd&quot;, &quot;do&quot;, &quot;rn&quot;, &quot;bba&quot;, &quot;mpa&quot;, &quot;meng&quot;, &quot;beng&quot;, &quot;mtech&quot;, &quot;btech&quot;,&#xD;&#xA;    &quot;pmp&quot;, &quot;cpa&quot;, &quot;cfa&quot;, &quot;frs&quot;, &quot;fieee&quot;, &quot;aaas&quot;, &quot;pe&quot;, &quot;cisa&quot;, &quot;cissp&quot;, &quot;cism&quot;, &quot;shrm-scp&quot;, &quot;shrm-cp&quot;, &quot;six-sigma&quot;,&#xD;&#xA;    &quot;lean&quot;, &quot;itil&quot;, &quot;scrum&quot;, &quot;psm&quot;, &quot;pspo&quot;, &quot;csd&quot;, &quot;sa&quot;, &quot;safe&quot;, &quot;sfpc&quot;, &quot;ceh&quot;, &quot;aws-ssa&quot;, &quot;aws-saa&quot;,&#xD;&#xA;    &quot;esq&quot;, &quot;esq.&quot;&#xD;&#xA;}&#xD;&#xA;Dim suffixes = New System.Collections.Generic.HashSet(Of String)(System.StringComparer.OrdinalIgnoreCase) From {&#xD;&#xA;    &quot;jr&quot;, &quot;jr.&quot;, &quot;sr&quot;, &quot;sr.&quot;, &quot;ii&quot;, &quot;iii&quot;, &quot;iv&quot;, &quot;v&quot;&#xD;&#xA;}&#xD;&#xA;Dim particles = New System.Collections.Generic.HashSet(Of String)(System.StringComparer.OrdinalIgnoreCase) From {&#xD;&#xA;    &quot;da&quot;, &quot;de&quot;, &quot;del&quot;, &quot;della&quot;, &quot;der&quot;, &quot;di&quot;, &quot;du&quot;, &quot;dos&quot;, &quot;das&quot;, &quot;la&quot;, &quot;le&quot;, &quot;van&quot;, &quot;von&quot;, &quot;zu&quot;, &quot;zur&quot;, &quot;zum&quot;,&#xD;&#xA;    &quot;ten&quot;, &quot;ter&quot;, &quot;bin&quot;, &quot;ibn&quot;, &quot;al&quot;, &quot;st&quot;, &quot;st.&quot;, &quot;san&quot;, &quot;santa&quot;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;' --- Helper lambdas ---&#xD;&#xA;Dim NormalizeTokenForCompare As System.Func(Of String, String) =&#xD;&#xA;    Function(token As String)&#xD;&#xA;        Dim t = If(token, &quot;&quot;).Trim().ToLowerInvariant()&#xD;&#xA;        If t.EndsWith(&quot;.&quot;) Then t = t.Substring(0, t.Length - 1)&#xD;&#xA;        Return t&#xD;&#xA;    End Function&#xD;&#xA;&#xD;&#xA;Dim NormalizeCredentialToken As System.Func(Of String, String) =&#xD;&#xA;    Function(token As String)&#xD;&#xA;        Dim t = If(token, &quot;&quot;).Trim()&#xD;&#xA;        t = t.Replace(&quot;.&quot;, &quot;&quot;).Replace(&quot;-&quot;, &quot;&quot;).Replace(&quot;â€™&quot;, &quot;&quot;).Replace(&quot;'&quot;, &quot;&quot;)&#xD;&#xA;        Return t.ToLowerInvariant()&#xD;&#xA;    End Function&#xD;&#xA;&#xD;&#xA;Dim IsTitleToken As System.Func(Of String, Boolean) =&#xD;&#xA;    Function(tok As String) titles.Contains(NormalizeTokenForCompare(tok))&#xD;&#xA;&#xD;&#xA;Dim IsSuffixToken As System.Func(Of String, Boolean) =&#xD;&#xA;    Function(tok As String) suffixes.Contains(NormalizeTokenForCompare(tok))&#xD;&#xA;&#xD;&#xA;Dim IsParticle As System.Func(Of String, Boolean) =&#xD;&#xA;    Function(tok As String) particles.Contains(NormalizeTokenForCompare(tok))&#xD;&#xA;&#xD;&#xA;Dim WordTokensPreserveDots As System.Func(Of String, System.Collections.Generic.List(Of String)) =&#xD;&#xA;    Function(text As String)&#xD;&#xA;        Dim rx = New System.Text.RegularExpressions.Regex(&quot;\p{L}+(?:[â€™'\-]\p{L}+)*\.?&quot;, System.Text.RegularExpressions.RegexOptions.CultureInvariant)&#xD;&#xA;        Dim m = rx.Match(If(text, &quot;&quot;))&#xD;&#xA;        Dim list = New System.Collections.Generic.List(Of String)&#xD;&#xA;        While m.Success&#xD;&#xA;            list.Add(m.Value)&#xD;&#xA;            m = m.NextMatch()&#xD;&#xA;        End While&#xD;&#xA;        Return list&#xD;&#xA;    End Function&#xD;&#xA;&#xD;&#xA;Dim SplitByComma As System.Func(Of String, System.Collections.Generic.List(Of String)) =&#xD;&#xA;    Function(text As String)&#xD;&#xA;        Dim arr = (If(text, &quot;&quot;)).Split(New Char() {&quot;,&quot;c}, StringSplitOptions.RemoveEmptyEntries)&#xD;&#xA;        Dim list = New System.Collections.Generic.List(Of String)&#xD;&#xA;        For Each p In arr&#xD;&#xA;            Dim t = p.Trim()&#xD;&#xA;            If t.Length &gt; 0 Then list.Add(t)&#xD;&#xA;        Next&#xD;&#xA;        Return list&#xD;&#xA;    End Function&#xD;&#xA;&#xD;&#xA;Dim SplitByNonWord As System.Func(Of String, System.Collections.Generic.List(Of String)) =&#xD;&#xA;    Function(text As String)&#xD;&#xA;        Dim rx = New System.Text.RegularExpressions.Regex(&quot;[^\p{L}\.]+&quot;, System.Text.RegularExpressions.RegexOptions.CultureInvariant)&#xD;&#xA;        Dim arr = rx.Split(If(text, &quot;&quot;))&#xD;&#xA;        Dim list = New System.Collections.Generic.List(Of String)&#xD;&#xA;        For Each p In arr&#xD;&#xA;            Dim t = p.Trim()&#xD;&#xA;            If t.Length &gt; 0 Then list.Add(t)&#xD;&#xA;        Next&#xD;&#xA;        Return list&#xD;&#xA;    End Function&#xD;&#xA;&#xD;&#xA;Dim IsCredentialsToken As System.Func(Of String, Boolean) =&#xD;&#xA;    Function(tok As String) credentials.Contains(NormalizeCredentialToken(tok))&#xD;&#xA;&#xD;&#xA;Dim IsCredentialsBlob As System.Func(Of String, Boolean) =&#xD;&#xA;    Function(seg As String)&#xD;&#xA;        Dim parts = SplitByNonWord(seg)&#xD;&#xA;        If parts.Count = 0 Then Return False&#xD;&#xA;        For Each p In parts&#xD;&#xA;            If Not IsCredentialsToken(p) Then Return False&#xD;&#xA;        Next&#xD;&#xA;        Return True&#xD;&#xA;    End Function&#xD;&#xA;&#xD;&#xA;Dim IsAllCredentials As System.Func(Of System.Collections.Generic.List(Of String), Boolean) =&#xD;&#xA;    Function(parts As System.Collections.Generic.List(Of String))&#xD;&#xA;        If parts Is Nothing OrElse parts.Count = 0 Then Return False&#xD;&#xA;        For Each p In parts&#xD;&#xA;            If Not IsCredentialsBlob(p) Then Return False&#xD;&#xA;        Next&#xD;&#xA;        Return True&#xD;&#xA;    End Function&#xD;&#xA;&#xD;&#xA;' --- Step 1: Remove emails &amp; phones ---&#xD;&#xA;Dim emailRx = New System.Text.RegularExpressions.Regex(&quot;\b[A-Z0-9._%+\-]+@[A-Z0-9.\-]+\.[A-Z]{2,}\b&quot;, System.Text.RegularExpressions.RegexOptions.IgnoreCase)&#xD;&#xA;s = emailRx.Replace(s, &quot; &quot;).Trim()&#xD;&#xA;&#xD;&#xA;Dim phoneRx = New System.Text.RegularExpressions.Regex(&quot;(?:(?:\+?\d[\s\-\.\(\)]*){7,}\d)&quot;)&#xD;&#xA;s = phoneRx.Replace(s, &quot; &quot;).Trim()&#xD;&#xA;&#xD;&#xA;' --- Step 2: Remove parenthetical credentials ---&#xD;&#xA;Dim parenRx = New System.Text.RegularExpressions.Regex(&quot;\(([^)]*)\)&quot;)&#xD;&#xA;s = parenRx.Replace(s, Function(m As System.Text.RegularExpressions.Match)&#xD;&#xA;    Dim inner = m.Groups(1).Value&#xD;&#xA;    Dim parts = SplitByNonWord(inner)&#xD;&#xA;    If IsAllCredentials(parts) Then Return &quot;&quot;&#xD;&#xA;    Return m.Value&#xD;&#xA;End Function).Trim()&#xD;&#xA;&#xD;&#xA;If s.Length = 0 Then&#xD;&#xA;    result = &quot;&quot;&#xD;&#xA;    Return&#xD;&#xA;End If&#xD;&#xA;&#xD;&#xA;' --- Local helpers: remove leading titles, trailing credentials, trailing &quot; , credentials&quot; ---&#xD;&#xA;Dim RemoveLeadingTitles As System.Func(Of String, String) =&#xD;&#xA;    Function(text As String)&#xD;&#xA;        Dim toks = WordTokensPreserveDots(text)&#xD;&#xA;        Dim i As Integer = 0&#xD;&#xA;        While i &lt; toks.Count AndAlso IsTitleToken(toks(i))&#xD;&#xA;            i += 1&#xD;&#xA;        End While&#xD;&#xA;        Dim kept = toks.GetRange(i, toks.Count - i)&#xD;&#xA;        Return String.Join(&quot; &quot;, kept)&#xD;&#xA;    End Function&#xD;&#xA;&#xD;&#xA;Dim RemoveTrailingCredentials As System.Func(Of String, String) =&#xD;&#xA;    Function(text As String)&#xD;&#xA;        Dim toks = WordTokensPreserveDots(text)&#xD;&#xA;        Dim i As Integer = toks.Count - 1&#xD;&#xA;        While i &gt;= 0 AndAlso IsCredentialsToken(toks(i))&#xD;&#xA;            i -= 1&#xD;&#xA;        End While&#xD;&#xA;        If i &lt; 0 Then Return &quot;&quot;&#xD;&#xA;        Dim kept = toks.GetRange(0, i + 1)&#xD;&#xA;        Return String.Join(&quot; &quot;, kept)&#xD;&#xA;    End Function&#xD;&#xA;&#xD;&#xA;Dim RemoveTrailingCredentialCommaChunk As System.Func(Of String, String) =&#xD;&#xA;    Function(text As String)&#xD;&#xA;        Dim idx = (If(text, &quot;&quot;)).IndexOf(&quot;,&quot;c)&#xD;&#xA;        If idx &lt; 0 Then Return text&#xD;&#xA;        Dim left = text.Substring(0, idx).Trim()&#xD;&#xA;        Dim right = text.Substring(idx + 1).Trim()&#xD;&#xA;        Dim parts = SplitByComma(right)&#xD;&#xA;        If IsAllCredentials(parts) Then&#xD;&#xA;            Return left&#xD;&#xA;        End If&#xD;&#xA;        Return text&#xD;&#xA;    End Function&#xD;&#xA;&#xD;&#xA;' --- Main branching: comma vs no comma ---&#xD;&#xA;Dim firstComma As Integer = s.IndexOf(&quot;,&quot;c)&#xD;&#xA;If firstComma &gt;= 0 Then&#xD;&#xA;    Dim left = s.Substring(0, firstComma).Trim()&#xD;&#xA;    Dim right = s.Substring(firstComma + 1).Trim()&#xD;&#xA;    Dim rightParts = SplitByComma(right)&#xD;&#xA;&#xD;&#xA;    If IsAllCredentials(rightParts) Then&#xD;&#xA;        ' Treat as western order&#xD;&#xA;        s = left&#xD;&#xA;        ' Fall through to western parsing below&#xD;&#xA;        firstComma = -1&#xD;&#xA;    Else&#xD;&#xA;        ' &quot;Last, First [Middle] [, Suffix] [, Credentials]&quot;&#xD;&#xA;        Dim suffix As String = &quot;&quot;&#xD;&#xA;        Dim filteredRight As New System.Collections.Generic.List(Of String)&#xD;&#xA;        For Each part In rightParts&#xD;&#xA;            Dim p = part.Trim()&#xD;&#xA;            If p.Length = 0 Then Continue For&#xD;&#xA;            If IsSuffixToken(p) Then&#xD;&#xA;                suffix = p&#xD;&#xA;            ElseIf Not IsCredentialsBlob(p) Then&#xD;&#xA;                filteredRight.Add(p)&#xD;&#xA;            End If&#xD;&#xA;        Next&#xD;&#xA;&#xD;&#xA;        Dim firstMiddle As String = If(filteredRight.Count &gt; 0, filteredRight(0).Trim(), &quot;&quot;)&#xD;&#xA;        left = RemoveLeadingTitles(left)&#xD;&#xA;        firstMiddle = RemoveLeadingTitles(firstMiddle)&#xD;&#xA;        left = RemoveTrailingCredentials(left).Trim()&#xD;&#xA;        firstMiddle = RemoveTrailingCredentials(firstMiddle).Trim()&#xD;&#xA;&#xD;&#xA;        If WordTokensPreserveDots(left).Count = 0 OrElse WordTokensPreserveDots(firstMiddle).Count = 0 Then&#xD;&#xA;            ' Fallback to western parse on original string without obvious credentials&#xD;&#xA;            s = (left &amp; &quot; &quot; &amp; firstMiddle).Trim()&#xD;&#xA;            firstComma = -1&#xD;&#xA;        Else&#xD;&#xA;            Dim lastWithParticles = left&#xD;&#xA;            Dim lastWithSuffix = If(suffix = &quot;&quot;, lastWithParticles, lastWithParticles &amp; &quot; &quot; &amp; suffix)&#xD;&#xA;            result = firstMiddle &amp; &quot; &quot; &amp; lastWithSuffix&#xD;&#xA;            Return&#xD;&#xA;        End If&#xD;&#xA;    End If&#xD;&#xA;End If&#xD;&#xA;&#xD;&#xA;' --- Western order parse: &quot;First [Middle ...] Last [Suffix]&quot; ---&#xD;&#xA;s = RemoveLeadingTitles(s)&#xD;&#xA;s = RemoveTrailingCredentials(s)&#xD;&#xA;s = RemoveTrailingCredentialCommaChunk(s).Trim()&#xD;&#xA;&#xD;&#xA;Dim tokens = WordTokensPreserveDots(s)&#xD;&#xA;If tokens.Count &lt; 2 Then&#xD;&#xA;    result = &quot;&quot;&#xD;&#xA;    Return&#xD;&#xA;End If&#xD;&#xA;&#xD;&#xA;Dim suffixKeep As String = &quot;&quot;&#xD;&#xA;If IsSuffixToken(tokens(tokens.Count - 1)) Then&#xD;&#xA;    suffixKeep = tokens(tokens.Count - 1)&#xD;&#xA;    tokens.RemoveAt(tokens.Count - 1)&#xD;&#xA;End If&#xD;&#xA;If tokens.Count &lt; 2 Then&#xD;&#xA;    result = &quot;&quot;&#xD;&#xA;    Return&#xD;&#xA;End If&#xD;&#xA;&#xD;&#xA;' Last cluster = last token + backward particles&#xD;&#xA;Dim lastStartIdx As Integer = tokens.Count - 1&#xD;&#xA;Dim lastNameParts = New System.Collections.Generic.List(Of String) From { tokens(lastStartIdx) }&#xD;&#xA;Dim iBack As Integer = lastStartIdx - 1&#xD;&#xA;While iBack &gt;= 0 AndAlso IsParticle(tokens(iBack))&#xD;&#xA;    lastNameParts.Insert(0, tokens(iBack))&#xD;&#xA;    iBack -= 1&#xD;&#xA;End While&#xD;&#xA;&#xD;&#xA;Dim firstMiddleTokens = tokens.GetRange(0, System.Math.Max(0, iBack + 1))&#xD;&#xA;If firstMiddleTokens.Count = 0 Then&#xD;&#xA;    result = &quot;&quot;&#xD;&#xA;    Return&#xD;&#xA;End If&#xD;&#xA;&#xD;&#xA;Dim firstMiddleName = String.Join(&quot; &quot;, firstMiddleTokens)&#xD;&#xA;Dim lastName = String.Join(&quot; &quot;, lastNameParts)&#xD;&#xA;Dim lastWithSuffixKeep = If(suffixKeep = &quot;&quot;, lastName, lastName &amp; &quot; &quot; &amp; suffixKeep)&#xD;&#xA;&#xD;&#xA;result = firstMiddleName &amp; &quot; &quot; &amp; lastWithSuffixKeep" DisplayName="Invoke Code - Normalize Candidate Name" sap:VirtualizedContainerService.HintSize="452,197" sap2010:WorkflowViewState.IdRef="InvokeCode_2">
        <ui:InvokeCode.Arguments>
          <InArgument x:TypeArguments="x:String" x:Key="inputName">[in_dictCV("CandidateName").ToLower]</InArgument>
          <OutArgument x:TypeArguments="x:String" x:Key="result">[normalizedName]</OutArgument>
        </ui:InvokeCode.Arguments>
      </ui:InvokeCode>
      <ui:InvokeCode ContinueOnError="{x:Null}" Code="' Arguments expected:&#xD;&#xA;'   inputName (In, String)&#xD;&#xA;'   result    (Out, String)&#xD;&#xA;&#xD;&#xA;Dim s As String = If(inputName, &quot;&quot;).Trim()&#xD;&#xA;If s = &quot;&quot; Then&#xD;&#xA;    result = &quot;&quot;&#xD;&#xA;    Return&#xD;&#xA;End If&#xD;&#xA;&#xD;&#xA;' --- Dictionaries (HashSets) ---&#xD;&#xA;Dim titles = New System.Collections.Generic.HashSet(Of String)(System.StringComparer.OrdinalIgnoreCase) From {&#xD;&#xA;    &quot;dr&quot;, &quot;dr.&quot;, &quot;doctor&quot;, &quot;prof&quot;, &quot;prof.&quot;, &quot;professor&quot;, &quot;mr&quot;, &quot;mr.&quot;, &quot;mrs&quot;, &quot;mrs.&quot;, &quot;ms&quot;, &quot;ms.&quot;, &quot;miss&quot;, &quot;sir&quot;,&#xD;&#xA;    &quot;ing&quot;, &quot;ing.&quot;, &quot;eng&quot;, &quot;eng.&quot;, &quot;lic&quot;, &quot;lic.&quot;, &quot;arq&quot;, &quot;arq.&quot;, &quot;rev&quot;, &quot;rev.&quot;, &quot;fr&quot;, &quot;fr.&quot;&#xD;&#xA;}&#xD;&#xA;Dim credentials = New System.Collections.Generic.HashSet(Of String)(System.StringComparer.OrdinalIgnoreCase) From {&#xD;&#xA;    &quot;phd&quot;, &quot;msc&quot;, &quot;ms&quot;, &quot;ma&quot;, &quot;mba&quot;, &quot;bsc&quot;, &quot;ba&quot;, &quot;bs&quot;, &quot;jd&quot;, &quot;md&quot;, &quot;edd&quot;, &quot;dphil&quot;, &quot;mpp&quot;, &quot;mph&quot;, &quot;mfa&quot;, &quot;llm&quot;,&#xD;&#xA;    &quot;llb&quot;, &quot;dds&quot;, &quot;dmd&quot;, &quot;do&quot;, &quot;rn&quot;, &quot;bba&quot;, &quot;mpa&quot;, &quot;meng&quot;, &quot;beng&quot;, &quot;mtech&quot;, &quot;btech&quot;,&#xD;&#xA;    &quot;pmp&quot;, &quot;cpa&quot;, &quot;cfa&quot;, &quot;frs&quot;, &quot;fieee&quot;, &quot;aaas&quot;, &quot;pe&quot;, &quot;cisa&quot;, &quot;cissp&quot;, &quot;cism&quot;, &quot;shrm-scp&quot;, &quot;shrm-cp&quot;, &quot;six-sigma&quot;,&#xD;&#xA;    &quot;lean&quot;, &quot;itil&quot;, &quot;scrum&quot;, &quot;psm&quot;, &quot;pspo&quot;, &quot;csd&quot;, &quot;sa&quot;, &quot;safe&quot;, &quot;sfpc&quot;, &quot;ceh&quot;, &quot;aws-ssa&quot;, &quot;aws-saa&quot;,&#xD;&#xA;    &quot;esq&quot;, &quot;esq.&quot;&#xD;&#xA;}&#xD;&#xA;Dim suffixes = New System.Collections.Generic.HashSet(Of String)(System.StringComparer.OrdinalIgnoreCase) From {&#xD;&#xA;    &quot;jr&quot;, &quot;jr.&quot;, &quot;sr&quot;, &quot;sr.&quot;, &quot;ii&quot;, &quot;iii&quot;, &quot;iv&quot;, &quot;v&quot;&#xD;&#xA;}&#xD;&#xA;Dim particles = New System.Collections.Generic.HashSet(Of String)(System.StringComparer.OrdinalIgnoreCase) From {&#xD;&#xA;    &quot;da&quot;, &quot;de&quot;, &quot;del&quot;, &quot;della&quot;, &quot;der&quot;, &quot;di&quot;, &quot;du&quot;, &quot;dos&quot;, &quot;das&quot;, &quot;la&quot;, &quot;le&quot;, &quot;van&quot;, &quot;von&quot;, &quot;zu&quot;, &quot;zur&quot;, &quot;zum&quot;,&#xD;&#xA;    &quot;ten&quot;, &quot;ter&quot;, &quot;bin&quot;, &quot;ibn&quot;, &quot;al&quot;, &quot;st&quot;, &quot;st.&quot;, &quot;san&quot;, &quot;santa&quot;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;' --- Helper lambdas ---&#xD;&#xA;Dim NormalizeTokenForCompare As System.Func(Of String, String) =&#xD;&#xA;    Function(token As String)&#xD;&#xA;        Dim t = If(token, &quot;&quot;).Trim().ToLowerInvariant()&#xD;&#xA;        If t.EndsWith(&quot;.&quot;) Then t = t.Substring(0, t.Length - 1)&#xD;&#xA;        Return t&#xD;&#xA;    End Function&#xD;&#xA;&#xD;&#xA;Dim NormalizeCredentialToken As System.Func(Of String, String) =&#xD;&#xA;    Function(token As String)&#xD;&#xA;        Dim t = If(token, &quot;&quot;).Trim()&#xD;&#xA;        t = t.Replace(&quot;.&quot;, &quot;&quot;).Replace(&quot;-&quot;, &quot;&quot;).Replace(&quot;â€™&quot;, &quot;&quot;).Replace(&quot;'&quot;, &quot;&quot;)&#xD;&#xA;        Return t.ToLowerInvariant()&#xD;&#xA;    End Function&#xD;&#xA;&#xD;&#xA;Dim IsTitleToken As System.Func(Of String, Boolean) =&#xD;&#xA;    Function(tok As String) titles.Contains(NormalizeTokenForCompare(tok))&#xD;&#xA;&#xD;&#xA;Dim IsSuffixToken As System.Func(Of String, Boolean) =&#xD;&#xA;    Function(tok As String) suffixes.Contains(NormalizeTokenForCompare(tok))&#xD;&#xA;&#xD;&#xA;Dim IsParticle As System.Func(Of String, Boolean) =&#xD;&#xA;    Function(tok As String) particles.Contains(NormalizeTokenForCompare(tok))&#xD;&#xA;&#xD;&#xA;Dim WordTokensPreserveDots As System.Func(Of String, System.Collections.Generic.List(Of String)) =&#xD;&#xA;    Function(text As String)&#xD;&#xA;        Dim rx = New System.Text.RegularExpressions.Regex(&quot;\p{L}+(?:[â€™'\-]\p{L}+)*\.?&quot;, System.Text.RegularExpressions.RegexOptions.CultureInvariant)&#xD;&#xA;        Dim m = rx.Match(If(text, &quot;&quot;))&#xD;&#xA;        Dim list = New System.Collections.Generic.List(Of String)&#xD;&#xA;        While m.Success&#xD;&#xA;            list.Add(m.Value)&#xD;&#xA;            m = m.NextMatch()&#xD;&#xA;        End While&#xD;&#xA;        Return list&#xD;&#xA;    End Function&#xD;&#xA;&#xD;&#xA;Dim SplitByComma As System.Func(Of String, System.Collections.Generic.List(Of String)) =&#xD;&#xA;    Function(text As String)&#xD;&#xA;        Dim arr = (If(text, &quot;&quot;)).Split(New Char() {&quot;,&quot;c}, StringSplitOptions.RemoveEmptyEntries)&#xD;&#xA;        Dim list = New System.Collections.Generic.List(Of String)&#xD;&#xA;        For Each p In arr&#xD;&#xA;            Dim t = p.Trim()&#xD;&#xA;            If t.Length &gt; 0 Then list.Add(t)&#xD;&#xA;        Next&#xD;&#xA;        Return list&#xD;&#xA;    End Function&#xD;&#xA;&#xD;&#xA;Dim SplitByNonWord As System.Func(Of String, System.Collections.Generic.List(Of String)) =&#xD;&#xA;    Function(text As String)&#xD;&#xA;        Dim rx = New System.Text.RegularExpressions.Regex(&quot;[^\p{L}\.]+&quot;, System.Text.RegularExpressions.RegexOptions.CultureInvariant)&#xD;&#xA;        Dim arr = rx.Split(If(text, &quot;&quot;))&#xD;&#xA;        Dim list = New System.Collections.Generic.List(Of String)&#xD;&#xA;        For Each p In arr&#xD;&#xA;            Dim t = p.Trim()&#xD;&#xA;            If t.Length &gt; 0 Then list.Add(t)&#xD;&#xA;        Next&#xD;&#xA;        Return list&#xD;&#xA;    End Function&#xD;&#xA;&#xD;&#xA;Dim IsCredentialsToken As System.Func(Of String, Boolean) =&#xD;&#xA;    Function(tok As String) credentials.Contains(NormalizeCredentialToken(tok))&#xD;&#xA;&#xD;&#xA;Dim IsCredentialsBlob As System.Func(Of String, Boolean) =&#xD;&#xA;    Function(seg As String)&#xD;&#xA;        Dim parts = SplitByNonWord(seg)&#xD;&#xA;        If parts.Count = 0 Then Return False&#xD;&#xA;        For Each p In parts&#xD;&#xA;            If Not IsCredentialsToken(p) Then Return False&#xD;&#xA;        Next&#xD;&#xA;        Return True&#xD;&#xA;    End Function&#xD;&#xA;&#xD;&#xA;Dim IsAllCredentials As System.Func(Of System.Collections.Generic.List(Of String), Boolean) =&#xD;&#xA;    Function(parts As System.Collections.Generic.List(Of String))&#xD;&#xA;        If parts Is Nothing OrElse parts.Count = 0 Then Return False&#xD;&#xA;        For Each p In parts&#xD;&#xA;            If Not IsCredentialsBlob(p) Then Return False&#xD;&#xA;        Next&#xD;&#xA;        Return True&#xD;&#xA;    End Function&#xD;&#xA;&#xD;&#xA;' --- Step 1: Remove emails &amp; phones ---&#xD;&#xA;Dim emailRx = New System.Text.RegularExpressions.Regex(&quot;\b[A-Z0-9._%+\-]+@[A-Z0-9.\-]+\.[A-Z]{2,}\b&quot;, System.Text.RegularExpressions.RegexOptions.IgnoreCase)&#xD;&#xA;s = emailRx.Replace(s, &quot; &quot;).Trim()&#xD;&#xA;&#xD;&#xA;Dim phoneRx = New System.Text.RegularExpressions.Regex(&quot;(?:(?:\+?\d[\s\-\.\(\)]*){7,}\d)&quot;)&#xD;&#xA;s = phoneRx.Replace(s, &quot; &quot;).Trim()&#xD;&#xA;&#xD;&#xA;' --- Step 2: Remove parenthetical credentials ---&#xD;&#xA;Dim parenRx = New System.Text.RegularExpressions.Regex(&quot;\(([^)]*)\)&quot;)&#xD;&#xA;s = parenRx.Replace(s, Function(m As System.Text.RegularExpressions.Match)&#xD;&#xA;    Dim inner = m.Groups(1).Value&#xD;&#xA;    Dim parts = SplitByNonWord(inner)&#xD;&#xA;    If IsAllCredentials(parts) Then Return &quot;&quot;&#xD;&#xA;    Return m.Value&#xD;&#xA;End Function).Trim()&#xD;&#xA;&#xD;&#xA;If s.Length = 0 Then&#xD;&#xA;    result = &quot;&quot;&#xD;&#xA;    Return&#xD;&#xA;End If&#xD;&#xA;&#xD;&#xA;' --- Local helpers: remove leading titles, trailing credentials, trailing &quot; , credentials&quot; ---&#xD;&#xA;Dim RemoveLeadingTitles As System.Func(Of String, String) =&#xD;&#xA;    Function(text As String)&#xD;&#xA;        Dim toks = WordTokensPreserveDots(text)&#xD;&#xA;        Dim i As Integer = 0&#xD;&#xA;        While i &lt; toks.Count AndAlso IsTitleToken(toks(i))&#xD;&#xA;            i += 1&#xD;&#xA;        End While&#xD;&#xA;        Dim kept = toks.GetRange(i, toks.Count - i)&#xD;&#xA;        Return String.Join(&quot; &quot;, kept)&#xD;&#xA;    End Function&#xD;&#xA;&#xD;&#xA;Dim RemoveTrailingCredentials As System.Func(Of String, String) =&#xD;&#xA;    Function(text As String)&#xD;&#xA;        Dim toks = WordTokensPreserveDots(text)&#xD;&#xA;        Dim i As Integer = toks.Count - 1&#xD;&#xA;        While i &gt;= 0 AndAlso IsCredentialsToken(toks(i))&#xD;&#xA;            i -= 1&#xD;&#xA;        End While&#xD;&#xA;        If i &lt; 0 Then Return &quot;&quot;&#xD;&#xA;        Dim kept = toks.GetRange(0, i + 1)&#xD;&#xA;        Return String.Join(&quot; &quot;, kept)&#xD;&#xA;    End Function&#xD;&#xA;&#xD;&#xA;Dim RemoveTrailingCredentialCommaChunk As System.Func(Of String, String) =&#xD;&#xA;    Function(text As String)&#xD;&#xA;        Dim idx = (If(text, &quot;&quot;)).IndexOf(&quot;,&quot;c)&#xD;&#xA;        If idx &lt; 0 Then Return text&#xD;&#xA;        Dim left = text.Substring(0, idx).Trim()&#xD;&#xA;        Dim right = text.Substring(idx + 1).Trim()&#xD;&#xA;        Dim parts = SplitByComma(right)&#xD;&#xA;        If IsAllCredentials(parts) Then&#xD;&#xA;            Return left&#xD;&#xA;        End If&#xD;&#xA;        Return text&#xD;&#xA;    End Function&#xD;&#xA;&#xD;&#xA;' --- Main branching: comma vs no comma ---&#xD;&#xA;Dim firstComma As Integer = s.IndexOf(&quot;,&quot;c)&#xD;&#xA;If firstComma &gt;= 0 Then&#xD;&#xA;    Dim left = s.Substring(0, firstComma).Trim()&#xD;&#xA;    Dim right = s.Substring(firstComma + 1).Trim()&#xD;&#xA;    Dim rightParts = SplitByComma(right)&#xD;&#xA;&#xD;&#xA;    If IsAllCredentials(rightParts) Then&#xD;&#xA;        ' Treat as western order&#xD;&#xA;        s = left&#xD;&#xA;        ' Fall through to western parsing below&#xD;&#xA;        firstComma = -1&#xD;&#xA;    Else&#xD;&#xA;        ' &quot;Last, First [Middle] [, Suffix] [, Credentials]&quot;&#xD;&#xA;        Dim suffix As String = &quot;&quot;&#xD;&#xA;        Dim filteredRight As New System.Collections.Generic.List(Of String)&#xD;&#xA;        For Each part In rightParts&#xD;&#xA;            Dim p = part.Trim()&#xD;&#xA;            If p.Length = 0 Then Continue For&#xD;&#xA;            If IsSuffixToken(p) Then&#xD;&#xA;                suffix = p&#xD;&#xA;            ElseIf Not IsCredentialsBlob(p) Then&#xD;&#xA;                filteredRight.Add(p)&#xD;&#xA;            End If&#xD;&#xA;        Next&#xD;&#xA;&#xD;&#xA;        Dim firstMiddle As String = If(filteredRight.Count &gt; 0, filteredRight(0).Trim(), &quot;&quot;)&#xD;&#xA;        left = RemoveLeadingTitles(left)&#xD;&#xA;        firstMiddle = RemoveLeadingTitles(firstMiddle)&#xD;&#xA;        left = RemoveTrailingCredentials(left).Trim()&#xD;&#xA;        firstMiddle = RemoveTrailingCredentials(firstMiddle).Trim()&#xD;&#xA;&#xD;&#xA;        If WordTokensPreserveDots(left).Count = 0 OrElse WordTokensPreserveDots(firstMiddle).Count = 0 Then&#xD;&#xA;            ' Fallback to western parse on original string without obvious credentials&#xD;&#xA;            s = (left &amp; &quot; &quot; &amp; firstMiddle).Trim()&#xD;&#xA;            firstComma = -1&#xD;&#xA;        Else&#xD;&#xA;            Dim lastWithParticles = left&#xD;&#xA;            Dim lastWithSuffix = If(suffix = &quot;&quot;, lastWithParticles, lastWithParticles &amp; &quot; &quot; &amp; suffix)&#xD;&#xA;            result = firstMiddle &amp; &quot; &quot; &amp; lastWithSuffix&#xD;&#xA;            Return&#xD;&#xA;        End If&#xD;&#xA;    End If&#xD;&#xA;End If&#xD;&#xA;&#xD;&#xA;' --- Western order parse: &quot;First [Middle ...] Last [Suffix]&quot; ---&#xD;&#xA;s = RemoveLeadingTitles(s)&#xD;&#xA;s = RemoveTrailingCredentials(s)&#xD;&#xA;s = RemoveTrailingCredentialCommaChunk(s).Trim()&#xD;&#xA;&#xD;&#xA;Dim tokens = WordTokensPreserveDots(s)&#xD;&#xA;If tokens.Count &lt; 2 Then&#xD;&#xA;    result = &quot;&quot;&#xD;&#xA;    Return&#xD;&#xA;End If&#xD;&#xA;&#xD;&#xA;Dim suffixKeep As String = &quot;&quot;&#xD;&#xA;If IsSuffixToken(tokens(tokens.Count - 1)) Then&#xD;&#xA;    suffixKeep = tokens(tokens.Count - 1)&#xD;&#xA;    tokens.RemoveAt(tokens.Count - 1)&#xD;&#xA;End If&#xD;&#xA;If tokens.Count &lt; 2 Then&#xD;&#xA;    result = &quot;&quot;&#xD;&#xA;    Return&#xD;&#xA;End If&#xD;&#xA;&#xD;&#xA;' Last cluster = last token + backward particles&#xD;&#xA;Dim lastStartIdx As Integer = tokens.Count - 1&#xD;&#xA;Dim lastNameParts = New System.Collections.Generic.List(Of String) From { tokens(lastStartIdx) }&#xD;&#xA;Dim iBack As Integer = lastStartIdx - 1&#xD;&#xA;While iBack &gt;= 0 AndAlso IsParticle(tokens(iBack))&#xD;&#xA;    lastNameParts.Insert(0, tokens(iBack))&#xD;&#xA;    iBack -= 1&#xD;&#xA;End While&#xD;&#xA;&#xD;&#xA;Dim firstMiddleTokens = tokens.GetRange(0, System.Math.Max(0, iBack + 1))&#xD;&#xA;If firstMiddleTokens.Count = 0 Then&#xD;&#xA;    result = &quot;&quot;&#xD;&#xA;    Return&#xD;&#xA;End If&#xD;&#xA;&#xD;&#xA;Dim firstMiddleName = String.Join(&quot; &quot;, firstMiddleTokens)&#xD;&#xA;Dim lastName = String.Join(&quot; &quot;, lastNameParts)&#xD;&#xA;Dim lastWithSuffixKeep = If(suffixKeep = &quot;&quot;, lastName, lastName &amp; &quot; &quot; &amp; suffixKeep)&#xD;&#xA;&#xD;&#xA;result = firstMiddleName &amp; &quot; &quot; &amp; lastWithSuffixKeep" DisplayName="Invoke Code - Normalize Chair Name" sap:VirtualizedContainerService.HintSize="452,197" sap2010:WorkflowViewState.IdRef="InvokeCode_3">
        <ui:InvokeCode.Arguments>
          <InArgument x:TypeArguments="x:String" x:Key="inputName">[in_dictChairMemo("Chair").ToString]</InArgument>
          <OutArgument x:TypeArguments="x:String" x:Key="result">[normalizedNameChair]</OutArgument>
        </ui:InvokeCode.Arguments>
      </ui:InvokeCode>
      <p:WordApplicationScope SensitivityLabel="{x:Null}" CreateNewFile="False" DisplayName="Word Application Scope" FilePath="[result.LocalPath]" sap:VirtualizedContainerService.HintSize="452,2671" sap2010:WorkflowViewState.IdRef="WordApplicationScope_1" SensitivityOperation="None">
        <p:WordApplicationScope.Body>
          <ActivityAction x:TypeArguments="ui:WordDocument">
            <ActivityAction.Argument>
              <DelegateInArgument x:TypeArguments="ui:WordDocument" Name="WordDocumentScope" />
            </ActivityAction.Argument>
            <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="450,2540" sap2010:WorkflowViewState.IdRef="Sequence_3">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <p:WordReplaceText Found="{x:Null}" DisplayName="Replace Text - System Date" sap:VirtualizedContainerService.HintSize="416,226" sap2010:WorkflowViewState.IdRef="WordReplaceText_1" Replace="[DateTime.Now.ToString(&quot;MMMM d, yyyy&quot;)]" ReplaceAll="False" Search="%[Date]" />
              <p:WordReplaceText Found="{x:Null}" DisplayName="Replace Text - Full Name" sap:VirtualizedContainerService.HintSize="416,226" sap2010:WorkflowViewState.IdRef="WordReplaceText_2" Replace="[System.Globalization.CultureInfo.CurrentCulture.TextInfo.ToTitleCase(normalizedName)]" ReplaceAll="True" Search="%[Name]" />
              <p:WordReplaceText Found="{x:Null}" DisplayName="Replace Text - Email Address" sap:VirtualizedContainerService.HintSize="416,226" sap2010:WorkflowViewState.IdRef="WordReplaceText_3" Replace="[in_dictCV(&quot;CvEmail&quot;)]" ReplaceAll="False" Search="%[Email Address]" />
              <p:WordReplaceText Found="{x:Null}" DisplayName="Replace Text - Last Name" sap:VirtualizedContainerService.HintSize="416,226" sap2010:WorkflowViewState.IdRef="WordReplaceText_4" Replace="[in_taskName.Split(&quot;,&quot;c)(0)]" ReplaceAll="False" Search="%[Last Name]" />
              <p:WordReplaceText Found="{x:Null}" DisplayName="Replace Text - Chair Name" sap:VirtualizedContainerService.HintSize="416,226" sap2010:WorkflowViewState.IdRef="WordReplaceText_5" Replace="[normalizedNameChair]" ReplaceAll="True" Search="%[Chair]" />
              <p:WordReplaceText Found="{x:Null}" DisplayName="Replace Text - Title" sap:VirtualizedContainerService.HintSize="416,226" sap2010:WorkflowViewState.IdRef="WordReplaceText_11" Replace="[in_title.ToString()]" ReplaceAll="False" Search="%[Title]" />
              <p:WordReplaceText Found="{x:Null}" DisplayName="Replace Text - Dept" sap:VirtualizedContainerService.HintSize="416,226" sap2010:WorkflowViewState.IdRef="WordReplaceText_7" Replace="[in_department.ToString()]" ReplaceAll="False" Search="%[Dept]" />
              <p:WordReplaceText Found="{x:Null}" DisplayName="Replace Text - Term" sap:VirtualizedContainerService.HintSize="416,226" sap2010:WorkflowViewState.IdRef="WordReplaceText_8" Replace="[numberToLetterDict(CInt(numberMatch)) + &quot; &quot; + &quot;years&quot;]" ReplaceAll="False" Search="%[Term]" />
              <p:WordReplaceText Found="{x:Null}" DisplayName="Replace Text - Start Date" sap:VirtualizedContainerService.HintSize="416,226" sap2010:WorkflowViewState.IdRef="WordReplaceText_9" Replace="[startDate]" ReplaceAll="False" Search="%[Date]" />
              <p:WordReplaceText Found="{x:Null}" DisplayName="Replace Text - End Date" sap:VirtualizedContainerService.HintSize="416,226" sap2010:WorkflowViewState.IdRef="WordReplaceText_6" Replace="[endDate]" ReplaceAll="False" Search="%[Date]" />
              <p:WordSaveAs DisplayName="Save Document As" FilePath="[saveFolder]" sap:VirtualizedContainerService.HintSize="416,216" sap2010:WorkflowViewState.IdRef="WordSaveAs_1" ReplaceExisting="False" />
            </Sequence>
          </ActivityAction>
        </p:WordApplicationScope.Body>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </p:WordApplicationScope>
      <ui:InvokeCode ContinueOnError="{x:Null}" Code="Dim url As String = &quot;https://app.asana.com/api/1.0/attachments&quot;&#xA;&#xA;Dim responseText As String = &quot;&quot;&#xA;Dim statusCodeValue As Integer = -1&#xA;&#xA;Dim client As New System.Net.Http.HttpClient()&#xA;&#xA;Try&#xA;    ' Auth header&#xA;    client.DefaultRequestHeaders.Authorization =&#xA;        New System.Net.Http.Headers.AuthenticationHeaderValue(&quot;Bearer&quot;, inPersonalAccessToken)&#xA;&#xA;    Dim form As New System.Net.Http.MultipartFormDataContent()&#xA;&#xA;    ' Required: parent (task GID)&#xA;    form.Add(New System.Net.Http.StringContent(inTaskGid), &quot;parent&quot;)&#xA;&#xA;    ' Required: file (binary)&#xA;    Dim bytes As Byte() = System.IO.File.ReadAllBytes(inFilePath)&#xA;    Dim fileContent As New System.Net.Http.ByteArrayContent(bytes)&#xA;    fileContent.Headers.ContentType =&#xA;        New System.Net.Http.Headers.MediaTypeHeaderValue(&quot;application/octet-stream&quot;)&#xA;&#xA;    form.Add(fileContent, &quot;file&quot;, System.IO.Path.GetFileName(inFilePath))&#xA;&#xA;    Dim resp As System.Net.Http.HttpResponseMessage = client.PostAsync(url, form).Result&#xA;&#xA;    statusCodeValue = CInt(resp.StatusCode)&#xA;    responseText = resp.Content.ReadAsStringAsync().Result&#xA;&#xA;Finally&#xA;    client.Dispose()&#xA;End Try&#xA;&#xA;outStatusCode = statusCodeValue&#xA;outResponse = responseText&#xA;" DisplayName="Invoke Code - Upload File" sap:VirtualizedContainerService.HintSize="452,197" sap2010:WorkflowViewState.IdRef="InvokeCode_4">
        <ui:InvokeCode.Arguments>
          <InArgument x:TypeArguments="x:String" x:Key="inPersonalAccessToken">
            <Literal x:TypeArguments="x:String">2/1212982367753843/1213153733282738:dedad1ffda66837ab8acbb188d255836</Literal>
          </InArgument>
          <InArgument x:TypeArguments="x:String" x:Key="inTaskGid">
            <VisualBasicValue x:TypeArguments="x:String" ExpressionText="in_taskGID" />
          </InArgument>
          <InArgument x:TypeArguments="x:String" x:Key="inFilePath">
            <VisualBasicValue x:TypeArguments="x:String" ExpressionText="saveFolder" />
          </InArgument>
          <OutArgument x:TypeArguments="x:Int32" x:Key="outStatusCode">
            <VisualBasicReference x:TypeArguments="x:Int32" ExpressionText="statusCode" />
          </OutArgument>
          <OutArgument x:TypeArguments="x:String" x:Key="outResponse">
            <VisualBasicReference x:TypeArguments="x:String" ExpressionText="apiResponse" />
          </OutArgument>
        </ui:InvokeCode.Arguments>
      </ui:InvokeCode>
      <Sequence DisplayName="Sequence - Update Task Status" sap:VirtualizedContainerService.HintSize="452,57" sap2010:WorkflowViewState.IdRef="Sequence_5">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <uwah:NetHttpRequest BasicAuthPassword="{x:Null}" BasicAuthSecurePassword="{x:Null}" BasicAuthUsername="{x:Null}" BinaryPayload="{x:Null}" ClientCertPassword="{x:Null}" ClientCertPath="{x:Null}" ClientCertSecurePassword="{x:Null}" Cookies="{x:Null}" CustomNegotiatedAuthCredentials="{x:Null}" FilePath="{x:Null}" FormData="{x:Null}" LocalFiles="{x:Null}" OutputFileName="{x:Null}" OutputFileTargetFolder="{x:Null}" Parameters="{x:Null}" PathResource="{x:Null}" ProxyConfiguration="{x:Null}" ResourceFiles="{x:Null}" AuthenticationType="OAuthToken" ContinueOnError="True" DisableSslVerification="False" DisplayName="HTTP Request - Update Ready to Review" EnableCookies="True" FileOverwrite="AutoRename" FollowRedirects="True" FormDataParts="[New List (Of FormDataPart) From _&#xA;{&#xA;&#x9;New FileFormDataPart(),&#xA;&#x9;New BinaryFormDataPart(),&#xA;&#x9;New TextFormDataPart()&#xA;}]" Headers="[new System.Collections.Generic.Dictionary(Of System.String, System.String) From { { &quot;Content-Type&quot;, &quot;application/json&quot; },{ &quot;Accept&quot;, &quot;application/json&quot; } }]" sap:VirtualizedContainerService.HintSize="416,443" sap2010:WorkflowViewState.IdRef="NetHttpRequest_1" InitialDelay="500" MaxRedirects="3" MaxRetryAfterDelay="30000" Method="PUT" Multiplier="2" OAuthToken="2/1212982367753843/1213153733282738:dedad1ffda66837ab8acbb188d255836" PreferRetryAfterValue="True" RequestBodyType="Text" RequestUrl="[updateStatusLink]" RetryCount="3" RetryPolicyType="Basic" RetryStatusCodes="[New List (Of System.Net.HttpStatusCode) From _&#xA;{&#xA;&#x9;System.Net.HttpStatusCode.RequestTimeout,&#xA;&#x9;System.Net.HttpStatusCode.TooManyRequests,&#xA;&#x9;System.Net.HttpStatusCode.InternalServerError,&#xA;&#x9;System.Net.HttpStatusCode.BadGateway,&#xA;&#x9;System.Net.HttpStatusCode.ServiceUnavailable,&#xA;&#x9;System.Net.HttpStatusCode.GatewayTimeout&#xA;}]" SaveRawRequestResponse="True" SaveResponseAsFile="True" TextPayload="[request]" TextPayloadContentType="application/json" TextPayloadEncoding="UTF-8" TlsProtocol="Automatic" UseJitter="True" UseOsNegotiatedAuthCredentials="True">
          <uwah:NetHttpRequest.TimeoutInMiliseconds>
            <InArgument x:TypeArguments="s:Nullable(x:Int32)">
              <Literal x:TypeArguments="s:Nullable(x:Int32)" Value="10000" />
            </InArgument>
          </uwah:NetHttpRequest.TimeoutInMiliseconds>
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
        </uwah:NetHttpRequest>
        <isactr:ConnectorHttpActivity Configuration="H4sIAAAAAAAACu1WS2/bMAz+K4OOg5vscTOGAnm4TbZs8Vq3Oww9KDYTq7ElVY+mnpH/Pkq2s3UJtgwodllzcEya/PiRJinX5IxBkemR4IYyDoqENZlyaU2jJ+HXmnyiJZCQlGBykZGAjJmWBa1a9cdOnVTSydooxlcoX8CdZQoyEhplIWgizURKDRMcDYciq8g22OFbVeyBRzyTgnHzBPA50AyU/oEkFreQOuQzoUpqUJOx1DlTVb1rwgQMhZUtgZtWc3rqQ2spuIZjQ99ZUNVTBP5ToIWT90s1Bs1WaF83AAMfrHm3zX3rMGEZuPRsAc3TC1h6j187oNNf08J6U3IeJeRme+O4PIK8zMXmKMip/iLUelmITfQgFWjtM2zqux8unl8m6BRfues4mkVJ5MRBMpp4Gkjk/8n12IZEw7k1B2f7Hw5HQ+G5a5+79u87JRV+aA8dBaCxSZe00HA8sNsSrW+s4J7BJqYKIxk3Crgt26Mt9BMfkCs8oHBUjJE67PeplD2qKae9VJQosf7r3iu0mrSjhP4Di/6KfduNIVAF6gVU7/PFS/9D+0GagnQDhoAFazj2bzU6BMQdyzheJ23CexbI/7M/W8J6i/dTrg3lKTzO4hr/m/hI0FNEWI7TLdQHQFdimaQmP/HJNFdPy7B7Zqo29DngxwFL8cHcb4Zub2Axuupj6ijtahYLr5tLUF3+IwXUgGM9omkO+ErE2spu09U7/VCJjQY1NVC2+lixEjcP8nVrCxdZTNM1XcHPub1565P7Db8DXAIyo3xlEQp14GqewIMZFiJd+0jb77/gqhoiCQAA" ConnectionId="1b792568-f673-4668-8c8a-69f8e85d4395" DisplayName="Asana HTTP Request" sap:VirtualizedContainerService.HintSize="416,498" sap2010:WorkflowViewState.IdRef="ConnectorHttpActivity_2" UiPathActivityTypeId="8e7dad69-7016-3a0b-bad0-1435a7cd7c28">
          <isactr:ConnectorHttpActivity.FieldObjects>
            <isactr:FieldObject Name="method" Type="FieldArgument">
              <isactr:FieldObject.Value>
                <InArgument x:TypeArguments="x:String">GET</InArgument>
              </isactr:FieldObject.Value>
            </isactr:FieldObject>
            <isactr:FieldObject Name="url" Type="FieldArgument">
              <isactr:FieldObject.Value>
                <InArgument x:TypeArguments="x:String">["/tasks/"+in_taskGID+"/subtasks"]</InArgument>
              </isactr:FieldObject.Value>
            </isactr:FieldObject>
            <isactr:FieldObject Name="headers" Type="FieldArgument" />
            <isactr:FieldObject Name="query" Type="FieldArgument" />
            <isactr:FieldObject Name="body" Type="FieldArgument" />
            <isactr:FieldObject Name="out_headers" Type="FieldArgument">
              <isactr:FieldObject.Value>
                <OutArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" />
              </isactr:FieldObject.Value>
            </isactr:FieldObject>
            <isactr:FieldObject Name="out_body" Type="FieldArgument">
              <isactr:FieldObject.Value>
                <OutArgument x:TypeArguments="x:String">[outSubtask]</OutArgument>
              </isactr:FieldObject.Value>
            </isactr:FieldObject>
            <isactr:FieldObject Name="out_code" Type="FieldArgument">
              <isactr:FieldObject.Value>
                <OutArgument x:TypeArguments="x:Int32" />
              </isactr:FieldObject.Value>
            </isactr:FieldObject>
          </isactr:ConnectorHttpActivity.FieldObjects>
        </isactr:ConnectorHttpActivity>
        <ui:DeserializeJson x:TypeArguments="njl:JObject" JsonSample="{x:Null}" Settings="{x:Null}" DisplayName="Deserialize JSON" sap:VirtualizedContainerService.HintSize="416,174" sap2010:WorkflowViewState.IdRef="DeserializeJson`1_1" JsonObject="[outSubtaskObject]" JsonString="[outSubtask]" />
        <Assign DisplayName="Assign - Create JArray" sap:VirtualizedContainerService.HintSize="416,175" sap2010:WorkflowViewState.IdRef="Assign_6">
          <Assign.To>
            <OutArgument x:TypeArguments="njl:JArray">[taskJArray]</OutArgument>
          </Assign.To>
          <Assign.Value>
            <InArgument x:TypeArguments="njl:JArray">[CType(outSubtaskObject("data"),JArray)]</InArgument>
          </Assign.Value>
        </Assign>
        <Assign DisplayName="Assign - Subtask GID" sap:VirtualizedContainerService.HintSize="416,175" sap2010:WorkflowViewState.IdRef="Assign_7">
          <Assign.To>
            <OutArgument x:TypeArguments="x:String">[draftTaskGID]</OutArgument>
          </Assign.To>
          <Assign.Value>
            <InArgument x:TypeArguments="x:String" xml:space="preserve">[taskJarray.
    Where(Function(t) t("name").ToString = "Dean’s Office drafts appointment letter").
    Select(Function(t) t("gid").ToString).
    FirstOrDefault()]</InArgument>
          </Assign.Value>
        </Assign>
        <Assign DisplayName="Assign - Ready to Review Request" sap:VirtualizedContainerService.HintSize="416,175" sap2010:WorkflowViewState.IdRef="Assign_9">
          <Assign.To>
            <OutArgument x:TypeArguments="x:String">[request]</OutArgument>
          </Assign.To>
          <Assign.Value>
            <InArgument x:TypeArguments="x:String">["{""data"":{""completed"":true}}"]</InArgument>
          </Assign.Value>
        </Assign>
        <uwah:NetHttpRequest BasicAuthPassword="{x:Null}" BasicAuthSecurePassword="{x:Null}" BasicAuthUsername="{x:Null}" BinaryPayload="{x:Null}" ClientCertPassword="{x:Null}" ClientCertPath="{x:Null}" ClientCertSecurePassword="{x:Null}" Cookies="{x:Null}" CustomNegotiatedAuthCredentials="{x:Null}" FilePath="{x:Null}" FormData="{x:Null}" LocalFiles="{x:Null}" OutputFileName="{x:Null}" OutputFileTargetFolder="{x:Null}" Parameters="{x:Null}" PathResource="{x:Null}" ProxyConfiguration="{x:Null}" ResourceFiles="{x:Null}" AuthenticationType="OAuthToken" ContinueOnError="True" DisableSslVerification="False" DisplayName="HTTP Request - Update Subtask" EnableCookies="True" FileOverwrite="AutoRename" FollowRedirects="True" FormDataParts="[New List (Of FormDataPart) From _&#xA;{&#xA;&#x9;New FileFormDataPart(),&#xA;&#x9;New BinaryFormDataPart(),&#xA;&#x9;New TextFormDataPart()&#xA;}]" Headers="[new System.Collections.Generic.Dictionary(Of System.String, System.String) From { { &quot;Content-Type&quot;, &quot;application/json&quot; },{ &quot;Accept&quot;, &quot;application/json&quot; } }]" sap:VirtualizedContainerService.HintSize="416,434" sap2010:WorkflowViewState.IdRef="NetHttpRequest_2" InitialDelay="500" MaxRedirects="3" MaxRetryAfterDelay="30000" Method="PUT" Multiplier="2" OAuthToken="2/1212982367753843/1213153733282738:dedad1ffda66837ab8acbb188d255836" PreferRetryAfterValue="True" RequestBodyType="Text" RequestUrl="[(&quot;https://app.asana.com/api/1.0&quot;+&quot;/tasks/&quot; + draftTaskGID).Trim]" RetryCount="3" RetryPolicyType="Basic" RetryStatusCodes="[New List (Of System.Net.HttpStatusCode) From _&#xA;{&#xA;&#x9;System.Net.HttpStatusCode.RequestTimeout,&#xA;&#x9;System.Net.HttpStatusCode.TooManyRequests,&#xA;&#x9;System.Net.HttpStatusCode.InternalServerError,&#xA;&#x9;System.Net.HttpStatusCode.BadGateway,&#xA;&#x9;System.Net.HttpStatusCode.ServiceUnavailable,&#xA;&#x9;System.Net.HttpStatusCode.GatewayTimeout&#xA;}]" SaveRawRequestResponse="True" SaveResponseAsFile="True" TextPayload="[request]" TextPayloadContentType="application/json" TextPayloadEncoding="UTF-8" TlsProtocol="Automatic" UseJitter="True" UseOsNegotiatedAuthCredentials="True">
          <uwah:NetHttpRequest.TimeoutInMiliseconds>
            <InArgument x:TypeArguments="s:Nullable(x:Int32)">
              <Literal x:TypeArguments="s:Nullable(x:Int32)" Value="10000" />
            </InArgument>
          </uwah:NetHttpRequest.TimeoutInMiliseconds>
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
        </uwah:NetHttpRequest>
      </Sequence>
      <Sequence DisplayName="Sequence - Update Assignee" sap:VirtualizedContainerService.HintSize="452,57" sap2010:WorkflowViewState.IdRef="Sequence_7">
        <Sequence.Variables>
          <Variable x:TypeArguments="njl:JObject" Name="outObjectAdminGID" />
          <Variable x:TypeArguments="x:String" Name="adminGID" />
        </Sequence.Variables>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <uwah:NetHttpRequest BasicAuthPassword="{x:Null}" BasicAuthSecurePassword="{x:Null}" BasicAuthUsername="{x:Null}" BinaryPayload="{x:Null}" ClientCertPassword="{x:Null}" ClientCertPath="{x:Null}" ClientCertSecurePassword="{x:Null}" Cookies="{x:Null}" CustomNegotiatedAuthCredentials="{x:Null}" FilePath="{x:Null}" FormData="{x:Null}" Headers="{x:Null}" LocalFiles="{x:Null}" OutputFileName="{x:Null}" OutputFileTargetFolder="{x:Null}" Parameters="{x:Null}" PathResource="{x:Null}" ProxyConfiguration="{x:Null}" ResourceFiles="{x:Null}" TextPayload="{x:Null}" AuthenticationType="OAuthToken" ContinueOnError="True" DisableSslVerification="False" DisplayName="HTTP Request" EnableCookies="True" FileOverwrite="AutoRename" FollowRedirects="True" FormDataParts="[New List (Of FormDataPart) From _&#xA;{&#xA;&#x9;New FileFormDataPart(),&#xA;&#x9;New BinaryFormDataPart(),&#xA;&#x9;New TextFormDataPart()&#xA;}]" sap:VirtualizedContainerService.HintSize="416,277" sap2010:WorkflowViewState.IdRef="NetHttpRequest_5" InitialDelay="500" MaxRedirects="3" MaxRetryAfterDelay="30000" Method="GET" Multiplier="2" OAuthToken="2/1212982367753843/1213153733282738:dedad1ffda66837ab8acbb188d255836" PreferRetryAfterValue="True" RequestBodyType="None" RequestUrl="[&quot;https://app.asana.com/api/1.0/users/&quot; + in_adminEmail]" Result="[outAdminGID]" RetryCount="3" RetryPolicyType="Basic" RetryStatusCodes="[New List (Of System.Net.HttpStatusCode) From _&#xA;{&#xA;&#x9;System.Net.HttpStatusCode.RequestTimeout,&#xA;&#x9;System.Net.HttpStatusCode.TooManyRequests,&#xA;&#x9;System.Net.HttpStatusCode.InternalServerError,&#xA;&#x9;System.Net.HttpStatusCode.BadGateway,&#xA;&#x9;System.Net.HttpStatusCode.ServiceUnavailable,&#xA;&#x9;System.Net.HttpStatusCode.GatewayTimeout&#xA;}]" SaveRawRequestResponse="False" SaveResponseAsFile="False" TextPayloadContentType="application/json" TextPayloadEncoding="UTF-8" TlsProtocol="Automatic" UseJitter="True" UseOsNegotiatedAuthCredentials="True">
          <uwah:NetHttpRequest.TimeoutInMiliseconds>
            <InArgument x:TypeArguments="s:Nullable(x:Int32)">
              <Literal x:TypeArguments="s:Nullable(x:Int32)" Value="10000" />
            </InArgument>
          </uwah:NetHttpRequest.TimeoutInMiliseconds>
        </uwah:NetHttpRequest>
        <ui:DeserializeJson x:TypeArguments="njl:JObject" JsonSample="{x:Null}" Settings="{x:Null}" DisplayName="Deserialize JSON" sap:VirtualizedContainerService.HintSize="416,174" sap2010:WorkflowViewState.IdRef="DeserializeJson`1_2" JsonObject="[outObjectAdminGID]" JsonString="[outAdminGID.TextContent]" />
        <Assign sap:VirtualizedContainerService.HintSize="416,175" sap2010:WorkflowViewState.IdRef="Assign_12">
          <Assign.To>
            <OutArgument x:TypeArguments="x:String">[adminGID]</OutArgument>
          </Assign.To>
          <Assign.Value>
            <InArgument x:TypeArguments="x:String">[outObjectAdminGID("data")("gid").ToString]</InArgument>
          </Assign.Value>
        </Assign>
        <Assign sap:VirtualizedContainerService.HintSize="416,175" sap2010:WorkflowViewState.IdRef="Assign_13">
          <Assign.To>
            <OutArgument x:TypeArguments="x:String">[request]</OutArgument>
          </Assign.To>
          <Assign.Value>
            <InArgument x:TypeArguments="x:String" xml:space="preserve">["{" &amp;  "  ""data"": {" &amp; "        "  &amp; "    ""assignee"": """  &amp; adminGID &amp;  """" &amp;  "  }" &amp; "}"]</InArgument>
          </Assign.Value>
        </Assign>
        <uwah:NetHttpRequest BasicAuthPassword="{x:Null}" BasicAuthSecurePassword="{x:Null}" BasicAuthUsername="{x:Null}" BinaryPayload="{x:Null}" ClientCertPassword="{x:Null}" ClientCertPath="{x:Null}" ClientCertSecurePassword="{x:Null}" Cookies="{x:Null}" CustomNegotiatedAuthCredentials="{x:Null}" FilePath="{x:Null}" FormData="{x:Null}" LocalFiles="{x:Null}" OutputFileName="{x:Null}" OutputFileTargetFolder="{x:Null}" Parameters="{x:Null}" PathResource="{x:Null}" ProxyConfiguration="{x:Null}" ResourceFiles="{x:Null}" AuthenticationType="OAuthToken" ContinueOnError="True" DisableSslVerification="False" DisplayName="HTTP Request" EnableCookies="True" FileOverwrite="AutoRename" FollowRedirects="True" FormDataParts="[New List (Of FormDataPart) From _&#xA;{&#xA;&#x9;New FileFormDataPart(),&#xA;&#x9;New BinaryFormDataPart(),&#xA;&#x9;New TextFormDataPart()&#xA;}]" Headers="[new System.Collections.Generic.Dictionary(Of System.String, System.String) From { { &quot;Content-Type&quot;, &quot;application/json&quot; },{ &quot;Accept&quot;, &quot;*/*&quot; } }]" sap:VirtualizedContainerService.HintSize="416,434" sap2010:WorkflowViewState.IdRef="NetHttpRequest_6" InitialDelay="500" MaxRedirects="3" MaxRetryAfterDelay="30000" Method="PUT" Multiplier="2" OAuthToken="2/1212982367753843/1213153733282738:dedad1ffda66837ab8acbb188d255836" PreferRetryAfterValue="True" RequestBodyType="Text" RequestUrl="[&quot;https://app.asana.com/api/1.0/tasks/&quot; + in_taskGID]" RetryCount="3" RetryPolicyType="Basic" RetryStatusCodes="[New List (Of System.Net.HttpStatusCode) From _&#xA;{&#xA;&#x9;System.Net.HttpStatusCode.RequestTimeout,&#xA;&#x9;System.Net.HttpStatusCode.TooManyRequests,&#xA;&#x9;System.Net.HttpStatusCode.InternalServerError,&#xA;&#x9;System.Net.HttpStatusCode.BadGateway,&#xA;&#x9;System.Net.HttpStatusCode.ServiceUnavailable,&#xA;&#x9;System.Net.HttpStatusCode.GatewayTimeout&#xA;}]" SaveRawRequestResponse="False" SaveResponseAsFile="False" TextPayload="[request]" TextPayloadContentType="application/json" TextPayloadEncoding="UTF-8" TlsProtocol="Automatic" UseJitter="True" UseOsNegotiatedAuthCredentials="True">
          <uwah:NetHttpRequest.TimeoutInMiliseconds>
            <InArgument x:TypeArguments="s:Nullable(x:Int32)">
              <Literal x:TypeArguments="s:Nullable(x:Int32)" Value="10000" />
            </InArgument>
          </uwah:NetHttpRequest.TimeoutInMiliseconds>
        </uwah:NetHttpRequest>
      </Sequence>
      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="452,166" sap2010:WorkflowViewState.IdRef="LogMessage_2" Level="Info" Message="[&quot;Ended Modify Adjunt Letter&quot;]" />
    </Sequence>
  </Sequence>
</Activity>